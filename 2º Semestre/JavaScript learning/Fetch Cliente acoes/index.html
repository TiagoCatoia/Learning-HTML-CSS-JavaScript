<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Cliente das informações de ações</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>

</head>
<body>
    <input type=text id="ticker">
    <button id="carregaHistorico">Carregar historico</button>
    <script>
        let botao = document.querySelector("#carregaHistorico")
        botao.addEventListener("click", function(){
            buscaTicker(ticker.value)
        })
        // buscaTicker("teste") // BBAS3

        function buscaTicker(ticker){
            fetch(`http://localhost:8000/historico/${ticker}`) // Sem anônima: let retornoFetch = fetch(`http://localhost:8000/historico/teste`)   retornoFetch.then()
            .then(
                (resposta) =>{
                    console.log("Dentro do tratamento inicial...")
                    return resposta.json() // json forma/formato de transcrever um objeto em js
                }
            )
            .then((cotacao)=>{
                console.log(cotacao)
                }
            )
            .catch(
                (erro)=>{
                    console.log(`Erro na requisição: ${erro}`)
                }
            )
            .finally(
                ()=>{
                    console.log(`Processamento terminado`)
                }
            )
            // (((resp.then()).then()).catch()).finally()
        }
        // manipular uma requisição http usando o segundo parâmetro options fetch("url, options")
        /*
        let options = {
            method: "POST",
            body: JSON.stringfy({
                val1: "Valor 1"
                val2: "Valor 2"
            head: 
            })
        }    
        */
    </script>
</body>
</html>